---
title: "Laboratorio Analisis Exploratorio"
author: "Dilary Cruz, Alexander de la Cruz, Daniel Juárez"
date: "2026-02-02"
output:
  pdf_document:
    latex_engine: xelatex
  word_document: default
  html_document: default
---


### Repositorio

<https://github.com/djuarez-2017510/Lab1-MineriaDatos>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(nortest)
options(scipen = 999)
```

```{r}
movies <- read.csv("movies_2026.csv", header = TRUE)
```

# PUNTO 1

### Dimensiones del conjunto de datos

dim(ms)

El conjunto de datos contiene 19,883 observaciones (películas) y 28 variables.

### Estructura de los datos

str(ms)

El dataset incluye variables cuantitativas y cualitativas, relacionadas con presupuesto, ingresos, duración, popularidad, género, elenco y características de producción.

### Resumen estadístico general

summary(ms)

El resumen estadístico permite observar medidas descriptivas de las variables cuantitativas, así como la presencia de valores cero en variables financieras y de votación, lo cual indica que no todas las películas cuentan con esta información disponible.

### Valores faltantes

colSums(is.na(ms))

Se identificó que algunas variables no cuentan con información completa para todas las películas, lo cual es común en conjuntos de datos reales y deberá considerarse en análisis posteriores.

### Vista preliminar del conjunto de datos

head(ms)

Las primeras filas permiten verificar que los datos fueron cargados correctamente y observar la estructura general de las variables.

### Tabla

```{r}
tabla_resumen <- data.frame(
  Caracteristica = c(
    "Número de observaciones",
    "Número de variables",
    "Variables cuantitativas",
    "Variables cualitativas",
    "Valores faltantes"
  ),
  Descripcion = c(
    "19,883 películas",
    "28 variables",
    "budget, revenue, runtime, popularity, voteAvg, voteCount, genresAmount, productionCoAmount, productionCountriesAmount, actorsAmount, castWomenAmount, castMenAmount, releaseYear",
    "genres, homePage, productionCompany, productionCompanyCountry, productionCountry, director, actors, actorsPopularity, actorsCharacter, originalTitle, title, originalLanguage, releaseDate",
    "Algunas películas no cuentan con información completa en todas las variables"
  )
)
```

```{r}
knitr::kable(
  tabla_resumen,
  caption = "Resumen general del conjunto de datos"
)
```

El conjunto de datos analizado contiene 19,883 películas y 28 variables. Dentro de las variables cuantitativas se incluye el campo id, el cual se utiliza únicamente como identificador de cada película y no como una variable de análisis. El dataset también contiene variables cuantitativas relacionadas con presupuesto, ingresos, duración y calificaciones, así como variables cualitativas que describen características como género, idioma, país de producción y elenco. Esta exploración permitió obtener una visión general de la estructura del conjunto de datos.

# PUNTO 2

```{r}
tabla_tipos <- data.frame(
  Variable = names(movies),
  Tipo_R = sapply(movies, class),
  Tipo_Variable = c(
    "Cualitativa nominal",      # id
    "Cuantitativa continua",    # popularity
    "Cuantitativa continua",    # budget
    "Cuantitativa continua",    # revenue
    "Cualitativa nominal",      # originalTitle
    "Cualitativa nominal",      # originalLanguage
    "Cualitativa nominal",      # title
    "Cualitativa nominal",      # homePage
    "Cualitativa nominal",      # video
    "Cualitativa nominal",      # director
    "Cuantitativa continua",    # runtime
    "Cualitativa nominal",      # genres
    "Cuantitativa discreta",    # genresAmount
    "Cualitativa nominal",      # productionCompany
    "Cuantitativa discreta",    # productionCoAmount
    "Cualitativa nominal",      # productionCompanyCountry
    "Cualitativa nominal",      # productionCountry
    "Cuantitativa discreta",    # productionCountriesAmount
    "Cualitativa ordinal",      # releaseDate 
    "Cuantitativa discreta",    # voteCount
    "Cuantitativa continua",    # voteAvg
    "Cualitativa nominal",      # actors
    "Cuantitativa continua",    # actorsPopularity
    "Cualitativa nominal",      # actorsCharacter
    "Cuantitativa discreta",    # actorsAmount
    "Cuantitativa discreta",    # castWomenAmount
    "Cuantitativa discreta",    # castMenAmount
    "Cuantitativa discreta"     # releaseYear
  )
)

```

```{r}
knitr::kable(
  tabla_tipos[, c("Variable", "Tipo_Variable")], 
  caption = "Clasificación de las variables del conjunto de datos",
  align = "l"
)
```

# PUNTO 3

```{r parte-3-completa, message=FALSE, warning=FALSE, fig.height=4, fig.width=6}
# =========================
# Librerías
# =========================


# =========================
# Variables cuantitativas
# =========================
#Limppiar actorsPopularity
pop_lista <- strsplit(movies$actorsPopularity, "\\|")
actors_pop <- as.numeric(unlist(pop_lista))
actors_pop <- actors_pop[!is.na(actors_pop)]

#14 variables cuantitativas
vars_cuant <- names(movies)[sapply(movies, is.numeric)]
vars_cuant <- vars_cuant[vars_cuant != "id"]
vars_cuant_lista <- lapply(vars_cuant, function(v) movies[[v]])
names(vars_cuant_lista) <- vars_cuant
vars_cuant_lista[["actorsPopularity"]] <- actors_pop

# =========================
# Normalidad: Lilliefors
# =========================


for (v in names(vars_cuant_lista)) {
  
  x <- vars_cuant_lista[[v]]
  x <- x[!is.na(x)]
  
  hist(
    x,
    breaks = 20,
    main = paste("Histograma de", v),
    xlab = v
  )
  
  prueba_lillie <- lillie.test(x)
  
  cat("\nVariable:", v, "\n")
  print(prueba_lillie)
  
  # Interpretación automática
  if (prueba_lillie$p.value >= 0.05) {
    cat(" La variable", v, "PODRÍA seguir una distribución normal.\n")
  } else {
    cat(" La variable", v, "NO sigue una distribución normal.\n")
  }
}


# =========================
# VARIABLES CUALITATIVAS (Tablas Completas y Gráficos Top 10)
# =========================

library(tidyverse)

analizar_cualitativa <- function(datos, columna, titulo) {
  
  # 1. Separar los valores por la barra vertical "|"
  df_temp <- datos %>%
    select(all_of(columna)) %>%
    separate_rows(all_of(columna), sep = "\\|") %>%
    filter(!is.na(!!sym(columna)) & !!sym(columna) != "")
  
  # 2. Crear tabla de frecuencia con TODOS los datos
  tabla_completa <- df_temp %>%
    count(!!sym(columna), sort = TRUE)
  
  # 3. Imprimir la tabla COMPLETA en el reporte
  print(knitr::kable(tabla_completa, caption = paste("Frecuencia Completa -", titulo)))
  
  # 4. Preparar datos para el gráfico
  tabla_top10 <- head(tabla_completa, 10)
  
  # 5. Generar gráfico con el Top 10
  par(mar = c(5, 10, 4, 2)) 
  
  barplot(
    height = rev(tabla_top10$n), # rev() es para que el más alto salga arriba
    names.arg = rev(tabla_top10[[columna]]), 
    horiz = TRUE,               # Lo hacemos horizontal para que se lean los nombres
    las = 1,                    # Etiquetas horizontales
    col = "steelblue",          # El color que te gusta
    main = paste(titulo, "(Top 10)"),
    xlab = "Frecuencia"
  )
}

# =========================
# CORRECCIÓN DE ENCODING (Importante para evitar el error UTF-8)
# =========================

# Forzamos la codificación a UTF-8 para evitar errores con caracteres extraños
# Esto reemplaza caracteres ilegibles con su código de byte
movies$productionCompany <- iconv(movies$productionCompany, from = "", to = "UTF-8", sub = "byte")
movies$originalTitle <- iconv(movies$originalTitle, from = "", to = "UTF-8", sub = "byte")
movies$title <- iconv(movies$title, from = "", to = "UTF-8", sub = "byte")

# --- Ejecución del análisis ---

# 1. Géneros
analizar_cualitativa(movies, "genres", "Géneros")

# 2. Idioma Original
analizar_cualitativa(movies, "originalLanguage", "Idioma Original")

# 3. Países de Producción
analizar_cualitativa(movies, "productionCountry", "Países Productores")

# 4. Compañías Productoras (Ahora funcionará porque limpiamos la columna arriba)
analizar_cualitativa(movies, "productionCompany", "Compañías Productoras")

# 5. Video Promocional
tabla_video <- table(movies$video)
print(knitr::kable(as.data.frame(tabla_video), caption = "Frecuencia: ¿Tiene Video?"))


# Nota metodológica
# =========================
# actorsPopularity es cuantitativa continua.
# video es cualitativa nominal

```

### PREGUNTAS

*1. ¿Cuáles son las 10 películas que contaron con más presupuesto?*

```{r}
top_budget <- movies |>
  dplyr::filter(!is.na(budget)) |>
  dplyr::arrange(desc(budget)) |>
  dplyr::select(title, budget) |>
  dplyr::slice(1:10)

top_budget
```

*2. ¿Cuáles son las 10 películas que más ingresos tuvieron?*

```{r}
top_revenue <- movies |>
  dplyr::filter(!is.na(revenue)) |>
  dplyr::arrange(desc(revenue)) |>
  dplyr::select(title, revenue) |>
  dplyr::slice(1:10)

top_revenue

```

*3. ¿Cuál es la película que más votos tuvo?*

```{r}
mas_votos <- movies |>
  dplyr::filter(!is.na(voteCount)) |>
  dplyr::arrange(desc(voteCount)) |>
  dplyr::select(title, voteCount) |>
  dplyr::slice(1)

mas_votos

```

*4. ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?*

```{r}
peor_pelicula <- movies |>
  dplyr::filter(!is.na(voteAvg), voteCount > 50) |>
  dplyr::arrange(voteAvg) |>
  dplyr::select(title, voteAvg, voteCount) |>
  dplyr::slice(1)

peor_pelicula

```

*5. ¿Cuántas películas se hicieron en cada año?*

```{r}
peliculas_por_anio <- movies |>
  dplyr::filter(!is.na(releaseYear)) |>
  dplyr::count(releaseYear)

peliculas_por_anio

```

*a. ¿En qué año se hicieron más películas?*
```{r}
anio_mas_peliculas <- peliculas_por_anio |>
  dplyr::arrange(desc(n)) |>
  dplyr::slice(1)

anio_mas_peliculas

barplot(
  peliculas_por_anio$n,
  names.arg = peliculas_por_anio$releaseYear,
  las = 2,
  col = "steelblue",
  main = "Cantidad de películas por año",
  xlab = "Año",
  ylab = "Cantidad de películas"
)

```




*6. ¿Cuál es el género principal de las 20 películas más recientes?*

```{r}
library(dplyr)
library(tidyr)
library(ggplot2)

movies <- movies %>%
  mutate(
    genero_principal = sapply(strsplit(genres, "\\|"), `[`, 1)
  )


top20_recientes <- movies %>%
  arrange(desc(releaseYear)) %>%
  slice(1:20) %>%
  count(genero_principal, sort = TRUE)

top20_recientes

```


*a. ¿Cuál es el género principal que predomina en el conjunto de datos? *

```{r}

genero_predominante <- movies %>%
  count(genero_principal, sort = TRUE)

head(genero_predominante)

barplot(
  genero_predominante$n,
  names.arg = genero_predominante$genero_principal,
  horiz = TRUE,
  las = 1,
  main = "Géneros principales más frecuentes",
  xlab = "Cantidad de películas"
)



```

*b. ¿A qué género principal pertenecen las películas más largas? *

```{r}
genero_mas_largo <- movies %>%
  filter(!is.na(runtime)) %>%
  group_by(genero_principal) %>%
  summarise(duracion_promedio = mean(runtime)) %>%
  arrange(desc(duracion_promedio))

head(genero_mas_largo)

```


*7. ¿Las películas de qué género principal obtuvieron mayores ganancias?*

```{r}
# 1. Calculamos la ganancia y definimos el objeto
movies$ganancia <- movies$revenue - movies$budget

ganancia_genero <- movies |>
  dplyr::filter(!is.na(ganancia), !is.na(genero_principal)) |>
  dplyr::group_by(genero_principal) |>
  dplyr::summarise(ganancia_total = sum(ganancia)) |>
  dplyr::arrange(desc(ganancia_total))

# 2. Ajustar márgenes para que no se corte nada
# Aumentamos el margen de abajo (10) y el de la izquierda (10)
par(mar = c(10, 10, 4, 2)) 

# 3. Escalar los datos a Millones para que el eje Y sea legible
ganancia_millones <- head(ganancia_genero$ganancia_total, 10) / 1000000
nombres_generos <- head(ganancia_genero$genero_principal, 10)

# 4. Generar el gráfico
barplot(
  height = ganancia_millones,
  names.arg = nombres_generos,
  las = 2,                  # Nombres en vertical para que quepan
  col = "darkgreen",
  main = "Top 10 Géneros con más Ganancias",
  ylab = "Ganancia (Millones de $)",
  cex.names = 0.8,          # Letra un poco más pequeña para los nombres
  cex.axis = 0.8            # Letra un poco más pequeña para los números
)
```



*8. ¿La cantidad de actores influye en los ingresos de las películas? ¿Se han hecho películas con más actores en los últimos años?*

```{r}
# Influencia en ingresos
plot(
  movies$actorsAmount, 
  movies$revenue, 
  main = "Cantidad de Actores vs Ingresos",
  xlab = "Número de Actores", 
  ylab = "Ingresos",
  pch = 19, col = rgb(0,0,1,0.2)
)

# Tendencia por años
actores_anio <- movies |>
  dplyr::group_by(releaseYear) |>
  dplyr::summarise(promedio_actores = mean(actorsAmount, na.rm = TRUE))

plot(
  actores_anio$releaseYear, 
  actores_anio$promedio_actores, 
  type = "l", 
  col = "red",
  main = "Evolución del tamaño del elenco por año",
  xlab = "Año", ylab = "Promedio de Actores"
)
```


Al ver que la correlación es casi nula no damos cuenta que llenar la película de actores no garantiza vender más entradas. Para el estudio, lo más inteligente es invertir en talento clave en lugar de gastar en repartos masivos que solo inflan los costos de producción sin aportar un valor real a la taquilla.




*9. ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos?*
```{r}
# Correlaciones simples para ver influencia
cor_mujeres_pop <- cor(movies$castWomenAmount, movies$popularity, use = "complete.obs")
cor_hombres_pop <- cor(movies$castMenAmount, movies$popularity, use = "complete.obs")

cor_mujeres_rev <- cor(movies$castWomenAmount, movies$revenue, use = "complete.obs")
cor_hombres_rev <- cor(movies$castMenAmount, movies$revenue, use = "complete.obs")

# Crear una pequeña matriz de resultados
resultados_genero <- data.frame(
  Variable = c("Mujeres vs Popularidad", "Hombres vs Popularidad", "Mujeres vs Ingresos", "Hombres vs Ingresos"),
  Correlacion = c(cor_mujeres_pop, cor_hombres_pop, cor_mujeres_rev, cor_hombres_rev)
)
resultados_genero
```


Se ve que repartos más equilibrados suelen tener mayor popularidad entre el público. Para CineVision, promover la diversidad no es solo un tema de imagen, sino una estrategia de negocio muy acertada para conectar con una audiencia mucho más amplia y moderna.



*10. ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?*
```{r}
directores_top <- movies |>
  dplyr::filter(voteCount > 100) |> # Filtro para que la calificación sea representativa
  dplyr::arrange(desc(voteAvg)) |>
  dplyr::select(director, title, voteAvg) |>
  dplyr::slice(1:20)

directores_top
```



*11. ¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos?*
```{r}
# Histograma del presupuesto
hist(
  movies$budget, 
  breaks = 30, 
  col = "lightblue", 
  main = "Distribución de Presupuestos",
  xlab = "Presupuesto"
)

# Diagrama de dispersión
plot(
  movies$budget, 
  movies$revenue, 
  main = "Presupuesto vs Ingresos",
  xlab = "Presupuesto", 
  ylab = "Ingresos",
  pch = 16, col = rgb(0,0.5,0,0.3)
)
abline(lm(revenue ~ budget, data = movies), col = "red") # Línea de tendencia
```



La gráfica confirma que el presupuesto ayuda, pero no es una garantía absoluta de éxito. He visto casos de películas carísimas que fracasaron, así que el estudio no debe confiarse solo del dinero; cada proyecto necesita una buena historia para que la inversión millonaria realmente valga la pena.


*12. ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?*

```{r}
# Convertir releaseDate a formato fecha
movies$releaseDate <- as.Date(movies$releaseDate)

# Extraer el mes de lanzamiento
movies$releaseMonth <- format(movies$releaseDate, "%m")

# Filtrar películas con ingresos válidos
movies_month <- subset(movies, !is.na(releaseMonth) & revenue > 0)

# Calcular ingresos promedio por mes
ingresos_por_mes <- aggregate(
  revenue ~ releaseMonth,
  data = movies_month,
  FUN = mean
)

# Convertir meses a factor con nombres
ingresos_por_mes$releaseMonth <- factor(
  ingresos_por_mes$releaseMonth,
  levels = sprintf("%02d", 1:12),
  labels = c("Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
             "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre")
)

# Gráfico de barras
par(mar = c(8, 5, 4, 2))

# grid
plot.new()
plot.window(
  xlim = c(0, length(ingresos_por_mes$revenue) + 1),
  ylim = c(0, max(ingresos_por_mes$revenue))
)
grid(nx = NA, ny = NULL, col = "gray85", lty = "dotted")

# gráfica
barplot(
  ingresos_por_mes$revenue,
  names.arg = ingresos_por_mes$releaseMonth,
  las = 2,
  col = "#9BD3E8",
  border = "steelblue4",
  add = TRUE
  
)

```



Los resultados muestran que los ingresos promedio de las películas presentan variaciones según el mes de lanzamiento, lo que sugiere que el momento del estreno puede estar asociado con el desempeño económico. Se observa que ciertos meses registran ingresos promedio más altos que otros, lo cual podría estar relacionado con temporadas vacacionales o periodos de mayor asistencia a las salas de cine. No obstante, aunque el mes de estreno parece influir en los ingresos, este factor por sí solo no garantiza el éxito comercial de una película, ya que intervienen otros elementos como el contenido, el elenco y la estrategia de marketing.




*13. ¿En qué meses se han visto los lanzamientos con mejores ingresos? ¿cuantas películas, en promedio, se han lanzado por mes? *

```{r}
# Asegurarse de que releaseDate sea fecha
movies$releaseDate <- as.Date(movies$releaseDate)

# Extraer mes de lanzamiento
movies$releaseMonth <- format(movies$releaseDate, "%m")

# --- PARTE 1: Ingresos promedio por mes ---

# Filtrar películas con ingresos válidos
movies_ingresos <- subset(movies, !is.na(releaseMonth) & revenue > 0)

# Ingresos promedio por mes
ingresos_mes <- aggregate(
  revenue ~ releaseMonth,
  data = movies_ingresos,
  FUN = mean
)

# --- PARTE 2: Cantidad promedio de películas por mes ---

# Contar cuántas películas se lanzaron por mes
conteo_mes <- table(movies$releaseMonth)

# Promedio de películas lanzadas por mes
promedio_lanzamientos <- mean(conteo_mes, na.rm = TRUE)

# Convertir meses a nombres
ingresos_mes$releaseMonth <- factor(
  ingresos_mes$releaseMonth,
  levels = sprintf("%02d", 1:12),
  labels = c("Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
             "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre")
)

# Gráfico de ingresos promedio por mes
barplot(
  ingresos_mes$revenue,
  names.arg = ingresos_mes$releaseMonth,
  las = 2,
  col = "lightblue",
  main = "Ingresos promedio por mes de lanzamiento",
  ylab = "Ingresos promedio",
  xlab = "Mes"
)

# Mostrar promedio de películas lanzadas por mes
promedio_lanzamientos
```



A partir del análisis realizado, se observa que los ingresos promedio de las películas varían según el mes de lanzamiento, lo que sugiere que el momento del estreno puede estar asociado con el desempeño económico, aunque no sea el único factor que influye en el éxito comercial. Asimismo, el cálculo de la cantidad promedio de películas lanzadas por mes permite identificar cómo se distribuyen los estrenos a lo largo del año, evidenciando que estos no se concentran de manera uniforme y que podrían responder a estrategias de mercado o a temporadas específicas de mayor demanda.




*14.¿Cómo se correlacionan las calificaciones con el éxito comercial?*

```{r}
# Filtrar películas con calificaciones e ingresos válidos
movies_14 <- subset(movies, voteAvg > 0 & revenue > 0)

# Diagrama de dispersión: calificación vs ingresos
plot(
  movies_14$voteAvg,
  movies_14$revenue,
  main = "Calificación promedio vs Ingresos",
  xlab = "Calificación promedio (voteAvg)",
  ylab = "Ingresos",
  pch = 16,
  col = rgb(0, 0, 1, 0.3)
)

# Línea de tendencia
abline(lm(revenue ~ voteAvg, data = movies_14), col = "red")

# Coeficiente de correlación
cor(movies_14$voteAvg, movies_14$revenue)

```




El análisis de la relación entre las calificaciones promedio de las películas y sus ingresos muestra la existencia de una asociación entre ambas variables, aunque esta no es necesariamente fuerte. El diagrama de dispersión y la línea de tendencia permiten observar que películas con mejores calificaciones tienden, en algunos casos, a obtener mayores ingresos, pero también existen películas con buenas calificaciones que no alcanzan un alto éxito comercial. Entonces, si bien la valoración del público puede influir en el desempeño económico, el éxito comercial de una película depende de múltiples factores adicionales como el presupuesto, la estrategia de marketing, el género y el momento de lanzamiento.



*15. ¿Qué estrategias de marketing, como videos promocionales o páginas oficiales, generan mejores resultados?*

```{r}
# Filtrar películas con ingresos válidos
movies_15 <- subset(movies, revenue > 0)

# Crear variable: tiene página oficial o no
movies_15$tieneHomePage <- movies_15$homePage != ""

# Ingresos promedio según existencia de video promocional
ingresos_video <- aggregate(
  revenue ~ video,
  data = movies_15,
  FUN = mean
)

# Ingresos promedio según existencia de página oficial
ingresos_homepage <- aggregate(
  revenue ~ tieneHomePage,
  data = movies_15,
  FUN = mean
)

# Gráfico: ingresos promedio según video promocional
barplot(
  ingresos_video$revenue,
  names.arg = ingresos_video$video,
  col = "lightblue",
  main = "Ingresos promedio según existencia de video promocional",
  ylab = "Ingresos promedio",
  xlab = "Tiene video promocional"
)

# Gráfico: ingresos promedio según página oficial
barplot(
  ingresos_homepage$revenue,
  names.arg = ingresos_homepage$tieneHomePage,
  col = "lightgreen",
  main = "Ingresos promedio según existencia de página oficial",
  ylab = "Ingresos promedio",
  xlab = "Tiene página oficial"
)
```






El análisis de las estrategias de marketing muestra diferencias en los ingresos promedio de las películas según la existencia de videos promocionales y páginas oficiales. Los resultados sugieren que las películas que cuentan con estos elementos tienden a presentar un mejor desempeño comercial en comparación con aquellas que no los tienen. Sin embargo, estas estrategias por sí solas no garantizan el éxito económico, ya que los ingresos también dependen de otros factores como el presupuesto, la popularidad del elenco y el contenido de la película. Aun así, la presencia de herramientas de promoción parece estar asociada con mayores ingresos promedio.






*16.¿La popularidad del elenco está directamente correlacionada con el éxito de taquilla?*

```{r}
# Filtrar películas con ingresos y popularidad del elenco válida
movies_16 <- subset(movies, revenue > 0 & actorsPopularity != "")

# Calcular la popularidad promedio del elenco por película
movies_16$avgActorsPopularity <- sapply(
  strsplit(movies_16$actorsPopularity, "\\|"),
  function(x) mean(suppressWarnings(as.numeric(x)), na.rm = TRUE)
)

# Eliminar valores NA resultantes
movies_16 <- subset(movies_16, !is.na(avgActorsPopularity))

# Diagrama de dispersión: popularidad del elenco vs ingresos
plot(
  movies_16$avgActorsPopularity,
  movies_16$revenue,
  main = "Popularidad promedio del elenco vs Ingresos",
  xlab = "Popularidad promedio del elenco",
  ylab = "Ingresos",
  pch = 16,
  col = rgb(1, 0, 0, 0.3)
)

# Línea de tendencia
abline(lm(revenue ~ avgActorsPopularity, data = movies_16), col = "blue")

# Coeficiente de correlación
cor(movies_16$avgActorsPopularity, movies_16$revenue)
```





El análisis muestra que existe una relación entre la popularidad promedio del elenco y los ingresos de las películas, aunque esta no es necesariamente fuerte ni directa. Si bien algunas películas con elencos más populares tienden a obtener mayores ingresos, también se observan numerosas excepciones, lo que indica que la popularidad del elenco puede influir en el éxito de taquilla, pero no es el único factor determinante.