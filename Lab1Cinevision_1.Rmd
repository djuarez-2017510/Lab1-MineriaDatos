---
title: "Laboratorio Analisis Exploratorio"
author: "Dilary Cruz, Alexander de la Cruz, Daniel Juárez"
date: "2026-02-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(nortest)
```

```{r}
movies <- read.csv("movies_2026.csv", header = TRUE)
```

#  PUNTO 1 

### Dimensiones del conjunto de datos
dim(ms)

El conjunto de datos contiene 19,883 observaciones (películas) y 28 variables.

### Estructura de los datos
str(ms)

El dataset incluye variables cuantitativas y cualitativas, relacionadas con presupuesto, ingresos, duración, popularidad, género, elenco y características de producción.

### Resumen estadístico general
summary(ms)

El resumen estadístico permite observar medidas descriptivas de las variables cuantitativas, así como la presencia de valores cero en variables financieras y de votación, lo cual indica que no todas las películas cuentan con esta información disponible.

### Valores faltantes
colSums(is.na(ms))

Se identificó que algunas variables no cuentan con información completa para todas las películas, lo cual es común en conjuntos de datos reales y deberá considerarse en análisis posteriores.

### Vista preliminar del conjunto de datos
head(ms)

Las primeras filas permiten verificar que los datos fueron cargados correctamente y observar la estructura general de las variables.

### Tabla 

```{r}
tabla_resumen <- data.frame(
  Caracteristica = c(
    "Número de observaciones",
    "Número de variables",
    "Variables cuantitativas",
    "Variables cualitativas",
    "Valores faltantes"
  ),
  Descripcion = c(
    "19,883 películas",
    "28 variables",
    "budget, revenue, runtime, popularity, voteAvg, voteCount, genresAmount, productionCoAmount, productionCountriesAmount, actorsAmount, castWomenAmount, castMenAmount, releaseYear",
    "genres, homePage, productionCompany, productionCompanyCountry, productionCountry, director, actors, actorsPopularity, actorsCharacter, originalTitle, title, originalLanguage, releaseDate",
    "Algunas películas no cuentan con información completa en todas las variables"
  )
)
```
```{r}
knitr::kable(
  tabla_resumen,
  caption = "Resumen general del conjunto de datos"
)
```

El conjunto de datos analizado contiene 19,883 películas y 28 variables. Dentro de las variables cuantitativas se incluye el campo id, el cual se utiliza únicamente como identificador de cada película y no como una variable de análisis. El dataset también contiene variables cuantitativas relacionadas con presupuesto, ingresos, duración y calificaciones, así como variables cualitativas que describen características como género, idioma, país de producción y elenco. Esta exploración permitió obtener una visión general de la estructura del conjunto de datos.



#  PUNTO 2 

```{r}
tabla_tipos <- data.frame(
  Variable = names(movies),
  Tipo_R = sapply(movies, class),
  Tipo_Variable = c(
    "Cualitativa nominal",      # id
    "Cuantitativa continua",    # popularity
    "Cuantitativa continua",    # budget
    "Cuantitativa continua",    # revenue
    "Cualitativa nominal",      # originalTitle
    "Cualitativa nominal",      # originalLanguage
    "Cualitativa nominal",      # title
    "Cualitativa nominal",      # homePage
    "Cualitativa nominal",      # video
    "Cualitativa nominal",      # director
    "Cuantitativa continua",    # runtime
    "Cualitativa nominal",      # genres
    "Cuantitativa discreta",    # genresAmount
    "Cualitativa nominal",      # productionCompany
    "Cuantitativa discreta",    # productionCoAmount
    "Cualitativa nominal",      # productionCompanyCountry
    "Cualitativa nominal",      # productionCountry
    "Cuantitativa discreta",    # productionCountriesAmount
    "Cualitativa ordinal",      # releaseDate 
    "Cuantitativa discreta",    # voteCount
    "Cuantitativa continua",    # voteAvg
    "Cualitativa nominal",      # actors
    "Cuantitativa continua",    # actorsPopularity
    "Cualitativa nominal",      # actorsCharacter
    "Cuantitativa discreta",    # actorsAmount
    "Cuantitativa discreta",    # castWomenAmount
    "Cuantitativa discreta",    # castMenAmount
    "Cuantitativa discreta"     # releaseYear
  )
)

```

```{r}
knitr::kable(
  tabla_tipos[, c("Variable", "Tipo_Variable")], 
  caption = "Clasificación de las variables del conjunto de datos",
  align = "l"
)
```


#  PUNTO 3


```{r parte-3-completa, message=FALSE, warning=FALSE, fig.height=4, fig.width=6}
# =========================
# Librerías
# =========================


# =========================
# Variables cuantitativas
# =========================
#Limppiar actorsPopularity
pop_lista <- strsplit(movies$actorsPopularity, "\\|")
actors_pop <- as.numeric(unlist(pop_lista))
actors_pop <- actors_pop[!is.na(actors_pop)]

#14 variables cuantitativas
vars_cuant <- names(movies)[sapply(movies, is.numeric)]
vars_cuant <- vars_cuant[vars_cuant != "id"]
vars_cuant_lista <- lapply(vars_cuant, function(v) movies[[v]])
names(vars_cuant_lista) <- vars_cuant
vars_cuant_lista[["actorsPopularity"]] <- actors_pop

# =========================
# Normalidad: Lilliefors
# =========================


for (v in names(vars_cuant_lista)) {
  
  x <- vars_cuant_lista[[v]]
  x <- x[!is.na(x)]
  
  hist(
    x,
    breaks = 20,
    main = paste("Histograma de", v),
    xlab = v
  )
  
  prueba_lillie <- lillie.test(x)
  
  cat("\nVariable:", v, "\n")
  print(prueba_lillie)
  
  # Interpretación automática
  if (prueba_lillie$p.value >= 0.05) {
    cat("➡ La variable", v, "PODRÍA seguir una distribución normal.\n")
  } else {
    cat("➡ La variable", v, "NO sigue una distribución normal.\n")
  }
}


# =========================
# VARIABLES CUALITATIVAS (Tablas Completas y Gráficos Top 10)
# =========================

library(tidyverse)

# Función modificada: Tabla con TODOS los datos, Gráfico solo TOP 10
analizar_cualitativa <- function(datos, columna, titulo) {
  
  # 1. Separar los valores por la barra vertical "|"
  df_temp <- datos %>%
    select(all_of(columna)) %>%
    separate_rows(all_of(columna), sep = "\\|") %>%
    filter(!is.na(!!sym(columna)) & !!sym(columna) != "")
  
  # 2. Crear tabla de frecuencia con TODOS los datos (sin head)
  tabla_completa <- df_temp %>%
    count(!!sym(columna), sort = TRUE)
  
  # 3. Imprimir la tabla COMPLETA en el reporte
  # Nota: Si son muchos datos, generará una tabla muy larga.
  print(knitr::kable(tabla_completa, caption = paste("Frecuencia Completa -", titulo)))
  
  # 4. Preparar datos para el gráfico (Solo Top 10 para que sea legible)
  tabla_top10 <- head(tabla_completa, 10)
  
  # 5. Generar gráfico con el Top 10
  p <- ggplot(tabla_top10, aes(x = reorder(!!sym(columna), n), y = n)) +
    geom_bar(stat = "identity", fill = "steelblue") +
    coord_flip() + 
    labs(title = paste(titulo, "(Top 10)"), x = "Categoría", y = "Frecuencia") +
    theme_minimal()
  
  print(p)
}

# =========================
# CORRECCIÓN DE ENCODING (Importante para evitar el error UTF-8)
# =========================

# Forzamos la codificación a UTF-8 para evitar errores con caracteres extraños
# Esto reemplaza caracteres ilegibles con su código de byte
movies$productionCompany <- iconv(movies$productionCompany, from = "", to = "UTF-8", sub = "byte")
movies$originalTitle <- iconv(movies$originalTitle, from = "", to = "UTF-8", sub = "byte")
movies$title <- iconv(movies$title, from = "", to = "UTF-8", sub = "byte")

# --- Ejecución del análisis ---

# 1. Géneros
analizar_cualitativa(movies, "genres", "Géneros")

# 2. Idioma Original
analizar_cualitativa(movies, "originalLanguage", "Idioma Original")

# 3. Países de Producción
analizar_cualitativa(movies, "productionCountry", "Países Productores")

# 4. Compañías Productoras (Ahora funcionará porque limpiamos la columna arriba)
analizar_cualitativa(movies, "productionCompany", "Compañías Productoras")

# 5. Video Promocional
tabla_video <- table(movies$video)
print(knitr::kable(as.data.frame(tabla_video), caption = "Frecuencia: ¿Tiene Video?"))



# =========================
# Nota metodológica
# =========================
# actorsPopularity es cuantitativa continua.
# video es cualitativa nominal binaria (TRUE / FALSE).

```

#PREGUNTAS



### Repositorio

https://github.com/djuarez-2017510/Lab1-MineriaDatos 



